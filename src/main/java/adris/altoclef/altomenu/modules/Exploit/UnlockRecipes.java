package adris.altoclef.altomenu.modules.Exploit;

import adris.altoclef.altomenu.Mod;
import adris.altoclef.altomenu.cheatUtils.CChatUtil;
import net.minecraft.client.MinecraftClient;
import net.minecraft.client.network.ClientPlayerEntity;
import net.minecraft.client.recipebook.ClientRecipeBook;
import net.minecraft.recipe.RecipeEntry;
import net.minecraft.recipe.RecipeManager;

import java.util.Objects;


//todo: Fix Crashing on Multiplayer Servers
// Volcan: should be fixed too busy to test also this code I wrote is absolute cancer
// Credits:
// Lagoon for ChatUtil Stuff (CChatUtil)
public class UnlockRecipes extends Mod {

    public UnlockRecipes() {
        super("UnlockRecipes", "Unlocks all recipes", Mod.Category.EXPLOIT);
    }

    //onEnable
    @Override
    public void onEnable() {
        if (!Objects.requireNonNull(mc.getServer()).isSingleplayer()) {
            CChatUtil.addChatMessage("UnlockRecipes can only be used in Singleplayer");
            super.toggle();
            return;
        }
        else {
            MinecraftClient client = net.minecraft.client.MinecraftClient.getInstance();
            ClientPlayerEntity player = mc.player;
            if (player != null) {
                ClientRecipeBook recipeBook = player.getRecipeBook();
                RecipeManager recipeManager = client.getServer().getRecipeManager();
                for (RecipeEntry<?> recipe : recipeManager.values()) {
                    recipeBook.add(recipe);
                    recipeBook.display(recipe);
                }
            }
        }
        super.onEnable();
    }
}
